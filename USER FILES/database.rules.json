{
    "rules": {
        "users": {
            ".read": "root.child('users').child(auth.uid).child('role').val() === 'admin'",
            "$uid": {
                ".read": "$uid === auth.uid || root.child('users').child(auth.uid).child('role').val() === 'admin'",
                ".write": "$uid === auth.uid || root.child('users').child(auth.uid).child('role').val() === 'admin'",
                ".indexOn": [
                    "email"
                ]
            }
        },
        "resources": {
            ".read": true,
            ".indexOn": [
                "unverified",
                "moduleId"
            ],
            "$resourceId": {
                ".write": "auth != null",
                ".validate": "newData.hasChildren(['title', 'type', 'createdAt', 'module', 'fullModuleName', 'moduleId'])"
            }
        },
        "module_resources": {
            ".read": true,
            ".write": "auth != null"
        },
        "clubs": {
            ".read": true,
            ".indexOn": [
                "verified"
            ],
            "$clubId": {
                ".write": "root.child('users').child(auth.uid).child('role').val() === 'admin' || (auth != null && (data.child('organizationalChart/président/email').val() === auth.token.email || data.child('organizationalChart/vice-président/email').val() === auth.token.email || data.child('organizationalChart/secrétaire/email').val() === auth.token.email || data.child('organizationalChart/trésorier/email').val() === auth.token.email))",
                "joinRequests": {
                    ".read": "root.child('users').child(auth.uid).child('role').val() === 'admin' || (auth != null && (root.child('clubs').child($clubId).child('organizationalChart/président/email').val() === auth.token.email || root.child('clubs').child($clubId).child('organizationalChart/vice-président/email').val() === auth.token.email || root.child('clubs').child($clubId).child('organizationalChart/secrétaire/email').val() === auth.token.email))",
                    "$requestId": {
                        ".write": "auth != null || !data.exists()"
                    }
                },
                "joinFormQuestions": {
                    ".read": "true",
                    ".write": "root.child('users').child(auth.uid).child('role').val() === 'admin' || (auth != null && (root.child('clubs').child($clubId).child('organizationalChart/président/email').val() === auth.token.email || root.child('clubs').child($clubId).child('organizationalChart/vice-président/email').val() === auth.token.email))"
                },
                "formSubmissions": {
                    "$formId": {
                        ".write": "true"
                    }
                },
                "forms": {
                    ".write": "root.child('users').child(auth.uid).child('role').val() === 'admin' || (auth != null && (data.parent().child('organizationalChart/président/email').val() === auth.token.email || data.parent().child('organizationalChart/vice-président/email').val() === auth.token.email))"
                }
            }
        },
        "clubRequests": {
            ".read": "root.child('users').child(auth.uid).child('role').val() === 'admin'",
            ".write": "auth != null"
        },
        "clubChangeRequests": {
            ".read": "root.child('users').child(auth.uid).child('role').val() === 'admin' || auth != null",
            ".write": "auth != null"
        },
        "clubPosts": {
            ".read": true,
            "$clubId": {
                ".write": "root.child('users').child(auth.uid).child('role').val() === 'admin' || (auth != null && (root.child('clubs').child($clubId).child('organizationalChart/président/email').val() === auth.token.email || root.child('clubs').child($clubId).child('organizationalChart/vice-président/email').val() === auth.token.email))"
            }
        },
        "adminAnnouncements": {
            ".read": true,
            ".write": "root.child('users').child(auth.uid).child('role').val() === 'admin'"
        },
        "chats": {
            ".read": "auth != null",
            ".write": "auth != null"
        },
        "reports": {
            ".write": "auth != null",
            ".read": "root.child('users').child(auth.uid).child('role').val() === 'admin'"
        },
        "tickets": {
            ".read": "auth != null && (query.orderByChild == 'userId' && query.equalTo == auth.uid) || root.child('users').child(auth.uid).child('role').val() === 'admin'",
            ".write": "true",
            ".indexOn": [
                "userId",
                "clubId",
                "status"
            ]
        },
        "metadata": {
            ".read": true,
            ".write": "root.child('users').child(auth.uid).child('role').val() === 'admin'"
        }
    }
}